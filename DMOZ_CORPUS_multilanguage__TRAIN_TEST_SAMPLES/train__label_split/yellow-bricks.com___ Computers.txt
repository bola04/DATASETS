<!DOCTYPE html>
 <html lang="en-US">
  <head>
   <meta charset="utf-8"/>
   <meta content="width=device-width, initial-scale=1" name="viewport"/>
   <title>
    Yellow Bricks
   </title>
   <!-- This site is optimized with the Yoast SEO plugin v7.8 - https://yoast.com/wordpress/plugins/seo/ -->
   <meta content="building blocks for virtualization" name="description"/>
   <link href="http://www.yellow-bricks.com/" rel="canonical"/>
   <meta content="summary" name="twitter:card"/>
   <meta content="building blocks for virtualization" name="twitter:description"/>
   <meta content="Yellow Bricks" name="twitter:title"/>
   <meta content="@DuncanYB" name="twitter:site"/>
   <script type="application/ld+json">
    {"@context":"https:\/\/schema.org","@type":"WebSite","@id":"#website","url":"http:\/\/www.yellow-bricks.com\/","name":"Yellow Bricks","potentialAction":{"@type":"SearchAction","target":"http:\/\/www.yellow-bricks.com\/?s={search_term_string}","query-input":"required name=search_term_string"}}
   </script>
   <!-- / Yoast SEO plugin. -->
   <link href="//s0.wp.com" rel="dns-prefetch"/>
   <link href="//secure.gravatar.com" rel="dns-prefetch"/>
   <link href="//fonts.googleapis.com" rel="dns-prefetch"/>
   <link href="//code.ionicframework.com" rel="dns-prefetch"/>
   <link href="//s.w.org" rel="dns-prefetch"/>
   <link href="http://feeds.feedburner.com/YellowBricks" rel="alternate" title="Yellow Bricks » Feed" type="application/rss+xml"/>
   <link href="http://feeds.feedburner.com/CommentsForYellowBricks" rel="alternate" title="Yellow Bricks » Comments Feed" type="application/rss+xml"/>
   <script type="text/javascript">
    window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.4\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.4\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/www.yellow-bricks.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.7"}};
 			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55357,56692,8205,9792,65039],[55357,56692,8203,9792,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
   </script>
   <style type="text/css">
    img.wp-smiley,
 img.emoji {
 	display: inline !important;
 	border: none !important;
 	box-shadow: none !important;
 	height: 1em !important;
 	width: 1em !important;
 	margin: 0 .07em !important;
 	vertical-align: -0.1em !important;
 	background: none !important;
 	padding: 0 !important;
 }
   </style>
   <link href="http://www.yellow-bricks.com/wp-content/themes/monochrome-pro/style.css?ver=1.0.0" id="monochrome-pro-css" media="all" rel="stylesheet" type="text/css"/>
   <style id="monochrome-pro-inline-css" type="text/css">
    .front-page-1 { background-image: url(//www.yellow-bricks.com/wp-content/themes/monochrome-pro/images/bg-1.jpg); }.front-page-3 { background-image: url(//www.yellow-bricks.com/wp-content/themes/monochrome-pro/images/bg-3.jpg); }.front-page-5 { background-image: url(//www.yellow-bricks.com/wp-content/themes/monochrome-pro/images/bg-5.jpg); }.front-page-7 { background-image: url(//www.yellow-bricks.com/wp-content/themes/monochrome-pro/images/bg-7.jpg); }
 
 		a,
 		.entry-meta a:hover,
 		.entry-meta a:focus,
 		.entry-title a:hover,
 		.entry-title a:focus,
 		.genesis-nav-menu a:focus,
 		.genesis-nav-menu a:hover,
 		.genesis-nav-menu .current-menu-item > a,
 		.genesis-nav-menu .toggle-header-search:focus,
 		.genesis-nav-menu .toggle-header-search:hover,
 		.genesis-responsive-menu .genesis-nav-menu a:focus,
 		.genesis-responsive-menu .genesis-nav-menu a:hover,
 		.sub-menu-toggle:focus,
 		.sub-menu-toggle:hover,
 		#genesis-mobile-nav-primary:focus,
 		#genesis-mobile-nav-primary:hover {
 			color: #e4b71d;
 		}
 
 		@media only screen and (max-width: 1023px) {
 			.genesis-responsive-menu .genesis-nav-menu a:focus,
 			.genesis-responsive-menu .genesis-nav-menu a:hover,
 			.genesis-responsive-menu .genesis-nav-menu .sub-menu .menu-item a:focus,
 			.genesis-responsive-menu .genesis-nav-menu .sub-menu .menu-item a:hover,
 			.genesis-responsive-menu.nav-primary .genesis-nav-menu .sub-menu .current-menu-item > a {
 				color: #e4b71d;
 			}
 		}
 
 		
 
 		button:hover,
 		button:focus,
 		input:hover[type="button"],
 		input:hover[type="reset"],
 		input:hover[type="submit"],
 		input:focus[type="button"],
 		input:focus[type="reset"],
 		input:focus[type="submit"],
 		.archive-pagination a:hover,
 		.archive-pagination a:focus,
 		.archive-pagination li.active a,
 		.button:hover,
 		.button:focus,
 		.image-section button:hover,
 		.image-section button:focus,
 		.image-section input[type="button"]:hover,
 		.image-section input[type="button"]:focus,
 		.image-section input[type="reset"]:hover,
 		.image-section input[type="reset"]:focus,
 		.image-section input[type="submit"]:hover,
 		.image-section input[type="submit"]:focus,
 		.image-section .button:hover,
 		.image-section .button:focus,
 		.image-section .more-link:hover,
 		.image-section .more-link:focus,
 		.more-link:hover,
 		.more-link:focus {
 			background-color: #e4b71d;
 			color: #000000;
 		}
 		
 			.before-footer-cta {
 				background-color: #e4b71d;
 				background: linear-gradient(45deg,#e4b71d,#f47607);
 			}
 
 			.before-footer-cta,
 			.before-footer-cta a,
 			.before-footer-cta p,
 			.before-footer-cta .widget-title {
 				color: #000000;
 			}
   </style>
   <link href="http://www.yellow-bricks.com/wp-includes/css/dashicons.min.css?ver=4.9.7" id="dashicons-css" media="all" rel="stylesheet" type="text/css"/>
   <link href="//fonts.googleapis.com/css?family=Muli%3A200%2C300%2C300i%2C400%2C400i%2C600%2C600i%7COpen+Sans+Condensed%3A300&amp;ver=1.0.0" id="monochrome-fonts-css" media="all" rel="stylesheet" type="text/css"/>
   <link href="//code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css?ver=1.0.0" id="monochrome-ionicons-css" media="all" rel="stylesheet" type="text/css"/>
   <link href="http://www.yellow-bricks.com/wp-content/plugins/simple-social-icons/css/style.css?ver=2.0.1" id="simple-social-icons-font-css" media="all" rel="stylesheet" type="text/css"/>
   <link href="http://www.yellow-bricks.com/wp-content/plugins/jetpack/modules/widgets/social-icons/social-icons.css?ver=20170506" id="jetpack-widget-social-icons-styles-css" media="all" rel="stylesheet" type="text/css"/>
   <link href="http://www.yellow-bricks.com/wp-content/tablepress-combined.min.css?ver=8" id="tablepress-default-css" media="all" rel="stylesheet" type="text/css"/>
   <link href="http://www.yellow-bricks.com/wp-content/plugins/jetpack/css/jetpack.css?ver=6.3.2" id="jetpack_css-css" media="all" rel="stylesheet" type="text/css"/>
   <script src="http://www.yellow-bricks.com/wp-includes/js/jquery/jquery.js?ver=1.12.4" type="text/javascript">
   </script>
   <script src="http://www.yellow-bricks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1" type="text/javascript">
   </script>
   <!--[if lt IE 9]>
 <script type='text/javascript' src='http://www.yellow-bricks.com/wp-content/themes/genesis/lib/js/html5shiv.min.js?ver=3.7.3'></script>
 <![endif]-->
   <script src="http://www.yellow-bricks.com/wp-content/plugins/simple-social-icons/svgxuse.js?ver=1.1.21" type="text/javascript">
   </script>
   <link href="http://www.yellow-bricks.com/wp-json/" rel="https://api.w.org/"/>
   <link href="http://www.yellow-bricks.com/xmlrpc.php?rsd" rel="EditURI" title="RSD" type="application/rsd+xml"/>
   <link href="http://www.yellow-bricks.com/wp-includes/wlwmanifest.xml" rel="wlwmanifest" type="application/wlwmanifest+xml"/>
   <meta content="WordPress 4.9.7" name="generator"/>
   <link href="https://wp.me/9Yzn" rel="shortlink"/>
   <!-- BuySellAds.com Ad Code -->
   <script type="text/javascript">
    (function(){
           var bsa = document.createElement('script');
               bsa.type= 'text/javascript';
               bsa.async = true;
               bsa.src='//s3.buysellads.com/ac/bsa.js';
           (document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(bsa);
         })();
   </script>
   <!-- END BuySellAds.com Ad Code -->
   <link href="//v0.wordpress.com" rel="dns-prefetch"/>
   <link href="//jetpack.wordpress.com" rel="dns-prefetch"/>
   <link href="//s0.wp.com" rel="dns-prefetch"/>
   <link href="//s1.wp.com" rel="dns-prefetch"/>
   <link href="//s2.wp.com" rel="dns-prefetch"/>
   <link href="//public-api.wordpress.com" rel="dns-prefetch"/>
   <link href="//0.gravatar.com" rel="dns-prefetch"/>
   <link href="//1.gravatar.com" rel="dns-prefetch"/>
   <link href="//2.gravatar.com" rel="dns-prefetch"/>
   <style type="text/css">
    .site-title a { background: url(http://www.yellow-bricks.com/wp-content/uploads/logo_yellow_bricks_rgb.jpg) no-repeat !important; }
   </style>
   <style media="screen" type="text/css">
    .simple-social-icons ul li a, .simple-social-icons ul li a:hover, .simple-social-icons ul li a:focus { background-color: #232525 !important; border-radius: 36px; color: #ffffff !important; border: 1px #ffffff solid !important; font-size: 18px; padding: 9px; }  .simple-social-icons ul li a:hover, .simple-social-icons ul li a:focus { background-color: #ffffff !important; border-color: #ffffff !important; color: #232525 !important; }  .simple-social-icons ul li a:focus { outline: 1px dotted #ffffff !important; }
   </style>
   <style id="syntaxhighlighteranchor" type="text/css">
   </style>
   <link href="http://www.yellow-bricks.com/wp-content/uploads/cropped-97a1aa732ca094e7845b7a6467d0d55c-1-32x32.png" rel="icon" sizes="32x32"/>
   <link href="http://www.yellow-bricks.com/wp-content/uploads/cropped-97a1aa732ca094e7845b7a6467d0d55c-1-192x192.png" rel="icon" sizes="192x192"/>
   <link href="http://www.yellow-bricks.com/wp-content/uploads/cropped-97a1aa732ca094e7845b7a6467d0d55c-1-180x180.png" rel="apple-touch-icon-precomposed"/>
   <meta content="http://www.yellow-bricks.com/wp-content/uploads/cropped-97a1aa732ca094e7845b7a6467d0d55c-1-270x270.png" name="msapplication-TileImage"/>
   <style id="wp-custom-css" type="text/css">
    .sidebar .widget {
     margin-bottom: 30px;
 }
 
 .entry {
     margin-bottom: 50px;
 }
 
 .header-image .title-area {
     height: 50px;
     margin-left: auto;
     margin-right: auto;
     margin-top: 5px;
     padding: 0;
     width: 300px;
 }
 
 table {
     border-collapse: collapse;
     border-spacing: 0;
     line-height: 2;
     margin-bottom: 40px;
     width: 100%;
     word-break: normal;
 }
 
 .entry-content code {
     background-color: #fff;
     color: #000;
 }
   </style>
  </head>
  <body class="home blog custom-header header-image header-full-width content-sidebar" itemscope="" itemtype="https://schema.org/WebPage">
   <div class="site-container">
    <ul class="genesis-skip-link">
     <li>
      <a class="screen-reader-shortcut" href="#genesis-nav-primary">
       Skip to primary navigation
      </a>
     </li>
     <li>
      <a class="screen-reader-shortcut" href="#genesis-content">
       Skip to content
      </a>
     </li>
     <li>
      <a class="screen-reader-shortcut" href="#genesis-sidebar-primary">
       Skip to primary sidebar
      </a>
     </li>
    </ul>
    <header class="site-header" itemscope="" itemtype="https://schema.org/WPHeader">
     <div class="wrap">
      <div class="title-area">
       <h1 class="site-title" itemprop="headline">
        <a href="http://www.yellow-bricks.com/">
         Yellow Bricks
        </a>
       </h1>
       <p class="site-description" itemprop="description">
        by Duncan Epping
       </p>
      </div>
      <nav aria-label="Main" class="nav-primary" id="genesis-nav-primary" itemscope="" itemtype="https://schema.org/SiteNavigationElement">
       <div class="wrap">
        <ul class="menu genesis-nav-menu menu-primary js-superfish" id="menu-topmenu">
         <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-11937" id="menu-item-11937">
          <a href="http://yellow-bricks.com" itemprop="url">
           <span itemprop="name">
            Home
           </span>
          </a>
         </li>
         <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7449" id="menu-item-7449">
          <a href="http://www.yellow-bricks.com/esxtop/" itemprop="url">
           <span itemprop="name">
            ESXTOP
           </span>
          </a>
         </li>
         <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-17622" id="menu-item-17622">
          <a href="http://www.yellow-bricks.com/stickersshirts/" itemprop="url">
           <span itemprop="name">
            Stickers/Shirts
           </span>
          </a>
         </li>
         <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-18482" id="menu-item-18482">
          <a href="http://www.yellow-bricks.com/privacy-policy/" itemprop="url">
           <span itemprop="name">
            Privacy Policy
           </span>
          </a>
         </li>
         <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7452" id="menu-item-7452">
          <a href="http://www.yellow-bricks.com/about/" itemprop="url" rel="author">
           <span itemprop="name">
            About
           </span>
          </a>
         </li>
         <li class="menu-item">
          <a aria-controls="header-search-wrap" aria-expanded="false" class="toggle-header-search" href="#header-search-wrap" role="button">
           <span class="screen-reader-text">
            Show Search
           </span>
           <span class="ionicons ion-ios-search">
           </span>
          </a>
         </li>
        </ul>
       </div>
      </nav>
      <div class="header-search-wrap" id="header-search-wrap">
       <form action="http://www.yellow-bricks.com/" class="search-form" itemprop="potentialAction" itemscope="" itemtype="https://schema.org/SearchAction" method="get" role="search">
        <meta content="http://www.yellow-bricks.com/?s={s}" itemprop="target"/>
        <label class="search-form-label screen-reader-text" for="searchform-5b5e1ef69f1075.48730528">
         Search this website
        </label>
        <input id="searchform-5b5e1ef69f1075.48730528" itemprop="query-input" name="s" placeholder="Search this website …" type="search"/>
        <input type="submit" value="Search"/>
       </form>
       <a aria-controls="header-search-wrap" aria-expanded="false" class="toggle-header-search close" href="#" role="button">
        <span class="screen-reader-text">
         Hide Search
        </span>
        <span class="ionicons ion-ios-close-empty">
        </span>
       </a>
      </div>
     </div>
    </header>
    <div class="site-inner">
     <div class="content-sidebar-wrap">
      <main class="content" id="genesis-content">
       <article class="post-18553 post type-post status-publish format-standard category-bcdr category-virtualization tag-6-5 tag-6-7 tag-admission-control tag-ha tag-vmware tag-vsphere entry" itemscope="" itemtype="https://schema.org/CreativeWork">
        <header class="entry-header">
         <h2 class="entry-title" itemprop="headline">
          <a class="entry-title-link" href="http://www.yellow-bricks.com/2018/07/12/insufficient-configured-resources-to-satisfy-the-desired-vsphere-ha-failover-level-on-the-cluster/" rel="bookmark">
           Insufficient configured resources to satisfy the desired vSphere HA failover level on the cluster
          </a>
         </h2>
         <p class="entry-meta">
          <time class="entry-time" datetime="2018-07-12T10:34:01+00:00" itemprop="datePublished">
           12 July, 2018
          </time>
          <span class="entry-comments-link">
           <a href="http://www.yellow-bricks.com/2018/07/12/insufficient-configured-resources-to-satisfy-the-desired-vsphere-ha-failover-level-on-the-cluster/#comments">
            4 Comments
           </a>
          </span>
         </p>
        </header>
        <div class="entry-content" itemprop="text">
         <p>
          I was talking to the HA team this week, specifically about the upcoming HA book. One thing they mentioned is that people still seem to struggle with the concept of admission control. This is the reason I wrote a whole chapter on it years ago, yet there still seems to be a lot of confusion. One thing that is not clear to people is the percentage calculations. We have some customers with VMs with extremely large reservations, in that case instead of using the “slot policy” they typically switch to “percentage based policy”. Simply as the percentage based policy is a lot more flexible.
         </p>
         <p>
          However, recently we have had some customers that hit the following error message:
         </p>
         <p style="padding-left: 30px;">
          <em>
           Insufficient configured resources to satisfy the desired vSphere HA failover level on the cluster
          </em>
         </p>
         <p>
          This error message, in the case of these particular situations (yes there was a bug as well, read this article on that), set the percentage lower than what would equal a full host. In other words, in a 4 host environment, a single host would equal 25%. In some cases, customers would set the percentage to a value lower than 25%. I am personally not sure why anyone would do this as it contradicts the whole essence of admission control. Nevertheless, it happens.
         </p>
         <p>
          This message indicates that you may not have sufficient resources, in the case of a host failure, to restart all the VMs. This of course is the result of the percentage being set lower than the value that would equal a single host. Note though, this does not stop you from powering on new VMs. You will only be stopped from powering on new VMs when you exceed the available unreserved resources.
         </p>
         <p>
          So if you are seeing this error message, please verify the configured percentage if you set it manually. Ensure that at a minimum it equals the largest host in the cluster.
         </p>
         <p>
          ** back to finalizing the book **
         </p>
         <p>
         </p>
        </div>
       </article>
       <article class="post-18549 post type-post status-publish format-standard category-virtualization category-storage category-various tag-6-5 tag-limit tag-mclock tag-scheduler tag-sioc tag-vsphere entry" itemscope="" itemtype="https://schema.org/CreativeWork">
        <header class="entry-header">
         <h2 class="entry-title" itemprop="headline">
          <a class="entry-title-link" href="http://www.yellow-bricks.com/2018/07/11/vsphere-6-5-and-limits-do-they-still-apply-to-svmotion/" rel="bookmark">
           vSphere 6.5 and limits, do they still apply to SvMotion?
          </a>
         </h2>
         <p class="entry-meta">
          <time class="entry-time" datetime="2018-07-11T15:45:04+00:00" itemprop="datePublished">
           11 July, 2018
          </time>
          <span class="entry-comments-link">
           <a href="http://www.yellow-bricks.com/2018/07/11/vsphere-6-5-and-limits-do-they-still-apply-to-svmotion/#comments">
            2 Comments
           </a>
          </span>
         </p>
        </header>
        <div class="entry-content" itemprop="text">
         <p>
          I had a question this week and I thought I wrote about this before but apparently, I did not. Hopefully by now most of you the I/O scheduler has changed over the past couple of years. Within ESXi, we moved to a new scheduler, which often is referred to as mClock. This new scheduler, and a new version of SIOC (storage i/o control) also resulted in some behavioral changes. Some which may be obvious, others which are not. I want to explicitly point out two things which I have discussed in the past which changed with vSphere 6.5 (and 6.7 as such) and both are around the use of limits.
         </p>
         <p>
          First of all: Limits and SvMotion. In the past when a limit was applied to a VM, this would also artificially limit SvMotion. As of vSphere 6.5 (may apply to 6.0 as well but I have not verified this) this is no longer the case. Starting vSphere 6.0 the I/O scheduler creates a queue for every file on the file system (VMFS), this to avoid for instance a VM stalling other types (metadata) of IO. The queues are called
          <a href="https://cormachogan.com/2015/11/13/io-scheduler-queues-improvement-for-virtual-machine-ios/" rel="noopener" target="_blank">
           SchedQ and briefly described by Cormac Hogan here
          </a>
          . Of course, there’s a lot more to it than Cormac or I discuss here, but I am not sure how much I can share so I am not going to go there. Either way, if you were used to limits being applied to SvMotion as well you are warned… this is no longer the case.
         </p>
         <p>
          Secondly, the normalization of I/Os changed with limits. In the past when a limit was applied IOs were normalized at 32KB, meaning that a 64KB I/O would count as 2 I/Os and a 4KB I/O would count as 1. This was confusing for a lot of people and as of vSphere 6.5 this is no longer the case. When you place a limit of 100 IOPS the VMDKs will be limited at 100 IOPS, regardless of the I/O size. This, by the way, was
          <a href="https://storagehub.vmware.com/t/vsphere-storage/vsphere-6-5-storage-1/storage-i-o-control-v2-2/" rel="noopener" target="_blank">
           documented here on storagehub
          </a>
          , not sure though how many people realized this.
         </p>
        </div>
       </article>
       <article class="post-18508 post type-post status-publish format-standard category-managementandautomation category-virtualization category-software-defined-2 category-storage category-vsan-2 tag-monitoring tag-opvizor tag-performance tag-startup tag-vsan tag-vsphere entry" itemscope="" itemtype="https://schema.org/CreativeWork">
        <header class="entry-header">
         <h2 class="entry-title" itemprop="headline">
          <a class="entry-title-link" href="http://www.yellow-bricks.com/2018/07/10/opvizor-performance-analyzer/" rel="bookmark">
           Opvizor Performance Analyzer for vSAN
          </a>
         </h2>
         <p class="entry-meta">
          <time class="entry-time" datetime="2018-07-10T15:35:46+00:00" itemprop="datePublished">
           10 July, 2018
          </time>
          <span class="entry-comments-link">
           <a href="http://www.yellow-bricks.com/2018/07/10/opvizor-performance-analyzer/#respond">
            Leave a Comment
           </a>
          </span>
         </p>
        </header>
        <div class="entry-content" itemprop="text">
         <p>
          At a VMUG a couple of months ago I bumped into my old friend Dennis Zimmer. Dennis told me that he was working on something cool for vSAN but couldn’t reveal what it was just yet. Last week I had a call with Dennis about what that thing was. Dennis is the CEO for
          <a href="https://www.opvizor.com/" rel="noopener" target="_blank">
           Opvizor
          </a>
          , and some of you may recall the different tooling that Opvizor has produced over the years, of which the Health Analyzer was probably the most famous one back then. I’ve used it in the past on various occasions and I had various customers using it. During the briefing, Dennis explained to me that Opvizor started focussing on performance monitoring and analytics a while ago as the health analyzer market was overly crowded and had the issue that is was a one-off business (checks once in a while instead of daily use). On top of that, many products now come with some form of health analysis included. (See vSAN for instance.) I have to agree with Dennis, so this pivot towards Performance Monitoring makes much sense to me.
         </p>
         <p>
          Dennis explained to me how they are seeing more and more customer demand for vSAN performance monitoring especially combined with VMware ESXi, VM and App data. Although vCenter has various metrics, and there’s VROps, he told me that Opvizor has many customers who need more than vCenter or vROPS standard has to offer today and don’t own VROps advanced. This is where Opvizor Performance Analyzer comes in to play and that is why
          <a href="https://www.opvizor.com/new-vmware-vsan-monitoring-and-performance-troubleshooting-extension" rel="noopener" target="_blank">
           today Opvizor announced they are including vSAN specific dashboards
          </a>
          . Now, this isn’t just for vSAN of course. Opvizor Performance Analyzer includes not just vSAN but also vSphere and various other parts of the stack. When talking with Dennis one thing became clear, Opvizor is taking a different approach than most other solutions. Where most focus on simplifying, hiding, and aggregating, the focus for Opvizor is on providing as much relevant detail as possible to fulfill the needs of beginner and professional.
         </p>
         <p>
          So how does it work? Opvizor provides a virtual appliance. You simply deploy it in your environment and connect it to vCenter and you are ready to go. The appliance collects data every 5 minutes (but 20 seconds intervals of these 5 minutes) and has a retention of up to 5 years. As I said, the focus is on infrastructure statistics and performance analytics and as such Opvizor delivers all the data you ever need.
         </p>
         <p>
          <img src="https://c2.staticflickr.com/2/1786/41400189410_a48f450c7e_z.jpg"/>
         </p>
         <p>
          It doesn’t just provide you with all the info you will ever need. It will also allow you to overlay different metrics, which makes performance troubleshooting a lot easier, and will allow you to correlate and pinpoint particular problems. Opvizor comes with dashboards for various aspects, here are the ones included in the upcoming release for vSAN:
         </p>
         <ul>
          <li>
           Capacity and Balance
          </li>
          <li>
           Storage Diskgroup Stats
          </li>
          <li>
           VM View
          </li>
          <li>
           Physical disk latency breakdown
          </li>
          <li>
           Cache Diskgroup stats
          </li>
          <li>
           vSAN Monitor
          </li>
         </ul>
         <p>
          Now I said this is the expert´s troubleshooting tool, but Opvizor Performance Analyzer also provided in-depth information about what each metric is / means and provides starter dashboards for beginners. You can simply click on the “i” in the top left corner of the widget and you get all the info about that particular widget.
         </p>
         <p>
          <img src="https://c2.staticflickr.com/2/1783/42492021814_3a3cbb1288_z.jpg"/>
         </p>
         <p>
          When you do know what you are looking for you can click, hover, and zoom when needed. Hover over the specific section in the graph and the point in time values of the metrics will pop up. In the case below I was drilling down on a VM in the vSAN cluster and looking at write latency in specific. As you can see we have 3 objects and in particular 2 disks and a “vm name space”.
         </p>
         <p>
          <img src="https://c1.staticflickr.com/1/845/43161082832_404f24083d_z.jpg"/>
         </p>
         <p>
          And this is just a random example, there are many metrics to look at and many different widgets and overviews. Just to give you an idea, here are some of the metrics you can find in the UI:
         </p>
         <ul>
          <li>
           Latency (for all different components of the stack)
          </li>
          <li>
           IOPs (for all different components of the stack)
          </li>
          <li>
           Bandwidth (for all different components of the stack)
          </li>
          <li>
           Congestion (for all different components of the stack)
          </li>
          <li>
           Outstanding I/O (for all different components of the stack)
          </li>
          <li>
           Read Cache Hit rate (for all different components of the stack)\
          </li>
          <li>
           ESXi vSAN host disk usage
          </li>
          <li>
           ESXi vSAN host cpu usage
          </li>
          <li>
           Number of Components
          </li>
          <li>
           Disk Usage
          </li>
          <li>
           Cache Usage
          </li>
         </ul>
         <p>
          And there;s much more, too many to list in this blog. And again, not just vSAN, but there are many dashboards to chose from. If you don’t have a performance monitoring solution yet and you are evaluating solutions like SolarWinds, Turbunomics and others make sure to add Opvizor to that list. One thing I have to say, I spotted a couple of things that I liked to see changed, and I think within 24hrs the Opvizor guys managed to incorporate the feedback. That was a crazy fast turnaround, good to see how receptive they are.
         </p>
         <p>
          <img src="https://c2.staticflickr.com/2/1804/28341276957_58bce77c20_z.jpg"/>
         </p>
         <p>
          Oh, one more thing I found in the interface, it is these dashboards that deal with things like NUMA. But also things like the Top 10 VMs in terms of IOPS. Both very useful, especially when doing deep performance troubleshooting and optimizing.
         </p>
         <p>
          <img src="https://c1.staticflickr.com/1/842/41424332830_9f6e284b0b_c.jpg"/>
         </p>
         <p>
          <img src="https://c1.staticflickr.com/1/925/43184568392_5d61d4f5f7_c.jpg"/>
         </p>
         <p>
          I hope that gives you a sense of what they can do. There’s a
          <a href="https://try.opvizor.com/health-analyzer/" rel="noopener" target="_blank">
           fully functional 30-day trial, check it out
          </a>
          if you want to find out more about Performance Analyzer or simply just want to play around with it. Opvizor announced this brand new version on
          <a href="https://www.opvizor.com/new-vmware-vsan-monitoring-and-performance-troubleshooting-extension" rel="noopener" target="_blank">
           their own blog here
          </a>
          , make sure to give that a read as well!
         </p>
        </div>
       </article>
       <article class="post-18545 post type-post status-publish format-standard category-bcdr category-virtualization category-software-defined-2 category-storage category-vsan-2 tag-6-5 tag-u2 tag-vmware tag-vsan tag-vsphere entry" itemscope="" itemtype="https://schema.org/CreativeWork">
        <header class="entry-header">
         <h2 class="entry-title" itemprop="headline">
          <a class="entry-title-link" href="http://www.yellow-bricks.com/2018/07/06/adding-a-fifth-virtual-esxi-host-to-vcenter-foundation/" rel="bookmark">
           Adding a fifth (virtual) ESXi host to vCenter Foundation
          </a>
         </h2>
         <p class="entry-meta">
          <time class="entry-time" datetime="2018-07-06T16:07:05+00:00" itemprop="datePublished">
           6 July, 2018
          </time>
          <span class="entry-comments-link">
           <a href="http://www.yellow-bricks.com/2018/07/06/adding-a-fifth-virtual-esxi-host-to-vcenter-foundation/#respond">
            Leave a Comment
           </a>
          </span>
         </p>
        </header>
        <div class="entry-content" itemprop="text">
         <p>
          When running a 4 node stretched cluster environment it should be possible to use “cheaper” vCenter Server licenses, namely vCenter Foundation. One of the limitations of vCenter Foundation is that you can only manage 4 hosts with it. This is where some customers who wanted to manage a stretched cluster hit some issues. The issue occurs at the point where you want to add the Witness VM to the inventory. Deploying the VM, of course, works fine, but it becomes problematic when you add the virtual ESXi host (Witness Appliance) to the vCenter Foundation instance as vCenter simply will not allow you to add a 5th host. Yes, this 5th host would be a witness, and will not be running any VMs, and even has a special license. Yet, the “add host” wizard does not differentiate between a regular host and a virtual witness appliance.
         </p>
         <p>
          Fortunately, there’s a workaround. It is fairly straightforward, and it has to do with the order in which you add hosts to vCenter Foundation. If you add the witness VM before the physical hosts then the appliance is not counted against the license. The license count (and allocation) apparently happens after the host has been added, but somehow vCenter does validate beforehand. I guess we do this to avoid abuse.
         </p>
         <p>
          So if you have vCenter Foundation, and want to build a stretched cluster leveraging a 2+2+1 configuration, meaning 4 physical hosts and 1 witness VM, then simply add the Witness VM to the inventory as a host first and then add the rest. For those wondering, yes this is documented in the
          <a href="https://docs.vmware.com/en/VMware-vSphere/6.5/rn/vsphere-vcenter-server-65u2-release-notes.html" rel="noopener" target="_blank">
           release notes of vSphere 6.5 Update
          </a>
          , all the way at the bottom.
         </p>
        </div>
       </article>
       <article class="post-18503 post type-post status-publish format-standard category-virtualization category-storage tag-6-0 tag-6-5 tag-6-7 tag-apd tag-ha tag-high-availability tag-pdl tag-vmware tag-vsphere-ha entry" itemscope="" itemtype="https://schema.org/CreativeWork">
        <header class="entry-header">
         <h2 class="entry-title" itemprop="headline">
          <a class="entry-title-link" href="http://www.yellow-bricks.com/2018/06/21/trigger-apd-on-iscsi-lun-on-vsphere/" rel="bookmark">
           Trigger APD on iSCSI LUN on vSphere
          </a>
         </h2>
         <p class="entry-meta">
          <time class="entry-time" datetime="2018-06-21T13:43:24+00:00" itemprop="datePublished">
           21 June, 2018
          </time>
          <span class="entry-comments-link">
           <a href="http://www.yellow-bricks.com/2018/06/21/trigger-apd-on-iscsi-lun-on-vsphere/#comments">
            5 Comments
           </a>
          </span>
         </p>
        </header>
        <div class="entry-content" itemprop="text">
         <p>
          I was testing various failure scenarios in my lab today for the vSphere Clustering Deepdive session I have scheduled for VMworld. I needed some screenshots and log files of when a datastore hit an APD scenario, for those who don’t know APD stands for all paths down. In other words: the storage is inaccessible and ESXi doesn’t know what has happened and why. vSphere HA has the ability to respond to that kind of failure. I wanted to test this, but my setup was fairly simple and virtual. So I couldn’t unplug any cables. I also couldn’t make configuration changes to the iSCSI array as that would rather trigger a PDL (permanent device loss), so how do you test and APD scenario?
         </p>
         <p>
          After trying various things like killing the iSCSI daemon (it gets restarted automatically with no impact on the workload) I bumped in to this command which triggered the APD:
         </p>
         <ul>
          <li>
           SSH in to the host you want to trigger the APD on, run the following command
           <pre class="p1"><span class="s1">esxcli iscsi session remove<span class="Apple-converted-space">  </span>-A vmhba65</span></pre>
          </li>
          <li>
           Make sure of course to replace “vmhba65” with the name of your iSCSI adapter
          </li>
         </ul>
         <p>
          This triggered APD, as witness in the fdm.log and vmkernel.log, and ultimately resulted in vSphere HA killing the impacted VM and restarting it on a healthy host. Anyway, just wanted to share this as I am sure there are others who would like to test APD responses in their labs or before their environment goes in to production.
         </p>
         <p>
          There may be other easy ways as well, if you know any, please share in the comments section.
         </p>
        </div>
       </article>
       <div class="archive-pagination pagination">
        <ul>
         <li class="active">
          <a aria-label="Current page" href="http://www.yellow-bricks.com/">
           <span class="screen-reader-text">
            Page
           </span>
           1
          </a>
         </li>
         <li>
          <a href="http://www.yellow-bricks.com/page/2/">
           <span class="screen-reader-text">
            Page
           </span>
           2
          </a>
         </li>
         <li>
          <a href="http://www.yellow-bricks.com/page/3/">
           <span class="screen-reader-text">
            Page
           </span>
           3
          </a>
         </li>
         <li class="pagination-omission">
          …
         </li>
         <li>
          <a href="http://www.yellow-bricks.com/page/425/">
           <span class="screen-reader-text">
            Page
           </span>
           425
          </a>
         </li>
         <li class="pagination-next">
          <a href="http://www.yellow-bricks.com/page/2/">
           Next Page »
          </a>
         </li>
        </ul>
       </div>
      </main>
      <aside aria-label="Primary Sidebar" class="sidebar sidebar-primary widget-area" id="genesis-sidebar-primary" itemscope="" itemtype="https://schema.org/WPSideBar" role="complementary">
       <h2 class="genesis-sidebar-title screen-reader-text">
        Primary Sidebar
       </h2>
       <section class="widget user-profile" id="user-profile-7">
        <div class="widget-wrap">
         <h3 class="widgettitle widget-title">
          About the author
         </h3>
         <p>
          <span class="alignleft">
           <img alt="" class="avatar avatar-65 photo" height="65" src="http://0.gravatar.com/avatar/0134bafc002b6c44121babfabb838c99?s=65&amp;d=mm&amp;r=g" srcset="http://0.gravatar.com/avatar/0134bafc002b6c44121babfabb838c99?s=130&amp;d=mm&amp;r=g 2x" width="65"/>
          </span>
          Duncan Epping is a Chief Technologist in the Office of CTO of the Storage &amp; Availability BU at VMware. He is a VCDX (# 007) and the author of multiple books including "Essential Virtual SAN" and the “vSphere Clustering Technical Deepdive” series.
         </p>
        </div>
       </section>
       <section class="widget simple-social-icons" id="simple-social-icons-4">
        <div class="widget-wrap">
         <ul class="alignleft">
          <li class="ssi-facebook">
           <a href="https://www.facebook.com/yellowbricksblog/">
            <svg aria-labelledby="social-facebook" class="social-facebook" role="img">
             <title id="social-facebook">
              Facebook
             </title>
             <use xlink:href="http://www.yellow-bricks.com/wp-content/plugins/simple-social-icons/symbol-defs.svg#social-facebook">
             </use>
            </svg>
           </a>
          </li>
          <li class="ssi-github">
           <a href="https://github.com/duncanyb">
            <svg aria-labelledby="social-github" class="social-github" role="img">
             <title id="social-github">
              Github
             </title>
             <use xlink:href="http://www.yellow-bricks.com/wp-content/plugins/simple-social-icons/symbol-defs.svg#social-github">
             </use>
            </svg>
           </a>
          </li>
          <li class="ssi-linkedin">
           <a href="https://nl.linkedin.com/in/depping">
            <svg aria-labelledby="social-linkedin" class="social-linkedin" role="img">
             <title id="social-linkedin">
              Linkedin
             </title>
             <use xlink:href="http://www.yellow-bricks.com/wp-content/plugins/simple-social-icons/symbol-defs.svg#social-linkedin">
             </use>
            </svg>
           </a>
          </li>
          <li class="ssi-rss">
           <a href="http://yellow-bricks.com/rss">
            <svg aria-labelledby="social-rss" class="social-rss" role="img">
             <title id="social-rss">
              RSS
             </title>
             <use xlink:href="http://www.yellow-bricks.com/wp-content/plugins/simple-social-icons/symbol-defs.svg#social-rss">
             </use>
            </svg>
           </a>
          </li>
          <li class="ssi-twitter">
           <a href="http://twitter.com/duncanyb">
            <svg aria-labelledby="social-twitter" class="social-twitter" role="img">
             <title id="social-twitter">
              Twitter
             </title>
             <use xlink:href="http://www.yellow-bricks.com/wp-content/plugins/simple-social-icons/symbol-defs.svg#social-twitter">
             </use>
            </svg>
           </a>
          </li>
         </ul>
        </div>
       </section>
       <section class="widget widget_text" id="text-7">
        <div class="widget-wrap">
         <h3 class="widgettitle widget-title">
          Sponsors
         </h3>
         <div class="textwidget">
          <div style="text-align:left">
           <a href="http://www.yellow-bricks.com/about/sponsorship/">
            Click to become a sponsor
           </a>
          </div>
          <!-- BuySellAds Zone Code -->
          <div class="bsarocks bsap_97a1aa732ca094e7845b7a6467d0d55c" id="bsap_1280563">
          </div>
          <!-- End BuySellAds Zone Code -->
         </div>
        </div>
       </section>
      </aside>
     </div>
    </div>
   </div>
   <footer class="site-footer" itemscope="" itemtype="https://schema.org/WPFooter">
    <div class="wrap">
     <p>
     </p>
    </div>
   </footer>
   <div style="display:none">
    <div class="grofile-hash-map-0134bafc002b6c44121babfabb838c99">
    </div>
   </div>
   <script src="https://s0.wp.com/wp-content/js/devicepx-jetpack.js?ver=201830" type="text/javascript">
   </script>
   <script src="https://secure.gravatar.com/js/gprofiles.js?ver=2018Julaa" type="text/javascript">
   </script>
   <script type="text/javascript">
    /* <![CDATA[ */
 var WPGroHo = {"my_hash":""};
 /* ]]> */
   </script>
   <script src="http://www.yellow-bricks.com/wp-content/plugins/jetpack/modules/wpgroho.js?ver=4.9.7" type="text/javascript">
   </script>
   <script src="http://www.yellow-bricks.com/wp-includes/js/hoverIntent.min.js?ver=1.8.1" type="text/javascript">
   </script>
   <script src="http://www.yellow-bricks.com/wp-content/themes/genesis/lib/js/menu/superfish.min.js?ver=1.7.5" type="text/javascript">
   </script>
   <script src="http://www.yellow-bricks.com/wp-content/themes/genesis/lib/js/menu/superfish.args.min.js?ver=2.6.1" type="text/javascript">
   </script>
   <script src="http://www.yellow-bricks.com/wp-content/themes/genesis/lib/js/skip-links.min.js?ver=2.6.1" type="text/javascript">
   </script>
   <script src="http://www.yellow-bricks.com/wp-content/themes/monochrome-pro/js/global.js?ver=1.0.0" type="text/javascript">
   </script>
   <script type="text/javascript">
    /* <![CDATA[ */
 var genesis_responsive_menu = {"mainMenu":"Menu","menuIconClass":"ionicons-before ion-navicon","subMenu":"Submenu","subMenuIconClass":"ionicons-before ion-chevron-down","menuClasses":{"combine":[],"others":[".nav-primary"]}};
 /* ]]> */
   </script>
   <script src="http://www.yellow-bricks.com/wp-content/themes/monochrome-pro/js/responsive-menus.min.js?ver=1.0.0" type="text/javascript">
   </script>
   <script src="http://www.yellow-bricks.com/wp-includes/js/wp-embed.min.js?ver=4.9.7" type="text/javascript">
   </script>
   <script async="async" defer="defer" src="https://stats.wp.com/e-201830.js" type="text/javascript">
   </script>
   <script type="text/javascript">
    _stq = window._stq || [];
 	_stq.push([ 'view', {v:'ext',j:'1:6.3.2',blog:'2377785',post:'0',tz:'2',srv:'www.yellow-bricks.com'} ]);
 	_stq.push([ 'clickTrackerInit', '2377785', '0' ]);
   </script>
  </body>
 </html>
 <!-- Dynamic page generated in 0.354 seconds. -->
